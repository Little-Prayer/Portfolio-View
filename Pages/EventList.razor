@inject HttpClient Http
@page "/events"
@page "/items/{id:int}/events"



@if (evList is null)
{
    <p>読み込み中</p>
}
else
{
    <table>
    <tr>
        <th>交換日</th>
        <th>アイテム名</th>
    </tr>
    @foreach (var ev in evList.OrderByDescending(e => e.Date))
        {
            <tr>
                <td>
                    <a href="events/@ev.EventId">
                        @(ev.Date.ToString("yyyy年MM月dd日"))
                    </a>
                </td>
                <td>
                    <a href="items/@ev.Item?.ItemId">
                        @ev.Item!.Name
                    </a>
                </td>
            </tr>
        }
    </table>
}
@code {
    private List<Event>? evList;

    [Parameter] public int? id { get; set; }

    protected override async Task OnParametersSetAsync() =>
    evList = await Http.GetFromJsonAsync<List<Event>>(id is null ? "event" : "item/" + id.Value.ToString() + "/event");

}